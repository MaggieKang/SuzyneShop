<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hannamsm.shop.domain.account.dao.AccountDao">
<select id="findByUserId" parameterType="String" resultType="com.hannamsm.shop.domain.account.vo.Account">
 select account_id    as accountId
      , account_email as accountEmail
      , password      as password
      , is_expired    as isExpired
      , is_locked     as isLocked
      , is_use        as isUse
   from account
  where account_id = #{accountId}
</select>
<select id="findByUserEmail" parameterType="String" resultType="com.hannamsm.shop.domain.account.vo.Account">
 select account_id    as accountId
      , account_email as accountEmail
      , password      as password
      , is_expired    as isExpired
      , is_locked     as isLocked
      , is_use        as isUse
   from account
  where account_email = #{accountEmail}
</select>
<select id="findRolesByUserId" parameterType="String" resultType="String">
select auth_cd
  from account_authority
 where account_id = #{accountId}
</select>
<insert id="createAccount" parameterType="com.hannamsm.shop.domain.account.vo.Account">
insert into account
(      id
     , password
     , is_expired
     , is_locked
     , is_use
     , reg_date
     , reg_person
     , last_mod_date
     , last_mod_person
) values (
       #{accountId}
     , #{password}
     , 0
     , 0
     , 0
     , 0
     , #{accountId}
     , getDate()
     , #{accountId}
     , getDate()
)
</insert>
<delete id="deleteAccount" parameterType="com.hannamsm.shop.domain.account.vo.Account">
update account
   set isEnabled = 1
     , lastModDate = getDate()
     , lastModPerson = #{accountId}
 where account_id = #{accountId}
</delete>
<insert id="createAuthority" parameterType="com.hannamsm.shop.domain.account.vo.AccountAuthority">
insert into account_authority
(      account_id
     , auth_cd
     , reg_date
     , reg_person
     , last_mod_date
     , last_mod_person
) values (
       #{accountId}
     , #{authCd}
     , getDate()
     , #{reg_person}
     , getDate()
     , #{last_mod_person}
);
</insert>
<delete id="deleteAuthority" parameterType="com.hannamsm.shop.domain.account.vo.AccountAuthority">
delete account_authority
 where id = #{accountId}
   and authority_code = #{authCd}
</delete>
<delete id="deleteAuthorities" parameterType="com.hannamsm.shop.domain.account.vo.AccountAuthority">
delete account_authority
 where id = #{accountId}
</delete>
</mapper>
