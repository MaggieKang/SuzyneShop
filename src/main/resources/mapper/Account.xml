<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hannamsm.shop.domain.account.dao.AccountDao">
<select id="findByUserNo" parameterType="int" resultType="com.hannamsm.shop.domain.account.vo.Account">
 select account_no    as accountNo
      , account_email as accountEmail
      , password      as password
      , is_expired    as isExpired
      , is_locked     as isLocked
      , is_use        as isUse
   from account
  where account_no = #{accountNo}
</select>
<select id="findByUserEmail" parameterType="String" resultType="com.hannamsm.shop.domain.account.vo.Account">
 select account_no    as accountNo
      , account_email as accountEmail
      , password      as password
      , is_expired    as isExpired
      , is_locked     as isLocked
      , is_use        as isUse
   from account
  where account_email = #{accountEmail}
</select>
<select id="findRolesByUserNo" parameterType="int" resultType="String">
select auth_cd
  from account_authority
 where account_no = #{accountNo}
</select>
<insert id="createAccount" parameterType="com.hannamsm.shop.domain.account.vo.Account">
insert into account
(      password
     , is_expired
     , is_locked
     , is_use
     , reg_date
     , reg_person
     , last_mod_date
     , last_mod_person
) values (
       #{password}
     , 0
     , 0
     , 0
     , 0
     , #{accountNo}
     , getDate()
     , #{accountNo}
     , getDate()
)
</insert>
<delete id="deleteAccount" parameterType="com.hannamsm.shop.domain.account.vo.Account">
update account
   set isEnabled = 1
     , lastModDate = getDate()
     , lastModPerson = #{accountNo}
 where account_no = #{accountNo}
</delete>
<insert id="createAuthority" parameterType="int">
insert into account_authority
(      account_no
     , auth_cd
     , reg_date
     , reg_person
     , last_mod_date
     , last_mod_person
) values (
       #{accountNo}
     , #{authCd}
     , getDate()
     , #{accountNo}
     , getDate()
     , #{accountNo}
);
</insert>
<delete id="deleteAuthority" parameterType="com.hannamsm.shop.domain.account.vo.AccountAuthority">
delete account_authority
 where account_no = #{accountNo}
   and authority_code = #{authCd}
</delete>
<delete id="deleteAuthorities" parameterType="com.hannamsm.shop.domain.account.vo.AccountAuthority">
delete account_authority
 where account_no = #{accountNo}
</delete>
</mapper>
